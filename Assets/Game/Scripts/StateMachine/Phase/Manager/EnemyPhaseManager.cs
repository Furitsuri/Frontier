using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class EnemyPhaseManager : PhaseManagerBase
{
    /// <summary>
    /// 初期化を行います
    /// </summary>
    override public void Init()
    {
        base.Init();
    }

    /// <summary>
    /// 更新を行います
    /// </summary>
    override public bool Update()
    {
        if (_isFirstUpdate)
        {
            // フェーズアニメーションの開始
            StartPhaseAnim();

            _isFirstUpdate = false;

            return false;
        }

        // フェーズアニメーション中は操作無効
        if (BattleUISystem.Instance.IsPlayingPhaseUI())
        {
            return false;
        }

        return base.Update();
    }

    override protected void CreateTree()
    {
        // 遷移木の作成
        RootNode = new EMSelectState();
        RootNode.AddChild(new EMMoveState());
        RootNode.AddChild(new EMAttackState());
        RootNode.AddChild(new EMWaitState());

        CurrentNode = RootNode;
    }

    /// <summary>
    /// フェーズアニメーションを再生します
    /// </summary>
    override protected void StartPhaseAnim()
    {
        BattleUISystem.Instance.TogglePhaseUI(true, BattleManager.TurnType.ENEMY_TURN);
        BattleUISystem.Instance.StartAnimPhaseUI();
    }
}
